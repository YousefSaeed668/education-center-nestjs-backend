enum Gender {
  ذكر
  انثى
}

enum Role {
  STUDENT
  TEACHER
  ADMIN
  GUARDIAN
}

model User {
  id             Int       @id @default(autoincrement())
  userName       String    @unique
  phoneNumber    String    @unique
  password       String
  displayName    String
  profilePicture String?
  gender         Gender
  student        Student?
  Teacher        Teacher?
  admin          Admin?
  role           Role      @default(STUDENT)
  Guardian       Guardian?
  refreshToken   String?
}

model Student {
  id   Int  @id
  user User @relation(fields: [id], references: [id], onDelete: Cascade)

  government      Government     @relation(fields: [governmentId], references: [id])
  governmentId    Int
  city            City           @relation(fields: [cityId], references: [id])
  cityId          Int
  educationType   EducationType  @relation(fields: [educationTypeId], references: [id])
  educationTypeId Int
  secondLang      SecondLanguage @relation(fields: [secondLangId], references: [id])
  secondLangId    Int
  schoolType      SchoolType     @relation(fields: [schoolTypeId], references: [id])
  schoolTypeId    Int

  guardian           Guardian? @relation(fields: [guardianId], references: [id])
  guardianId         Int?
  parentPhoneNumber  String
  isGuardianVerified Boolean   @default(false)
  grade              Grade     @relation(fields: [gradeId], references: [id])
  gradeId            Int
  division           Division  @relation(fields: [divisionId], references: [id])
  divisionId         Int
  schoolName         String
  Cart               Cart?
  Order              Order[]
}

model Government {
  id      Int       @id @default(autoincrement())
  name    String    @unique
  cities  City[]
  Student Student[]
}

model City {
  id           Int        @id @default(autoincrement())
  name         String
  government   Government @relation(fields: [governmentId], references: [id])
  governmentId Int
  students     Student[]

  @@unique([name, governmentId])
}

model EducationType {
  id       Int       @id @default(autoincrement())
  name     String    @unique
  students Student[]
  grade    Grade[]
  Teacher  Teacher[]
}

model Division {
  id       Int       @id @default(autoincrement())
  name     String
  students Student[]
  teachers Teacher[]
  courses  Course[]
  lectures Lecture[]
  grade    Grade     @relation(fields: [gradeId], references: [id])
  gradeId  Int

  @@unique([gradeId, name])
}

model SecondLanguage {
  id       Int       @id @default(autoincrement())
  name     String    @unique
  students Student[]
}

model SchoolType {
  id       Int       @id @default(autoincrement())
  name     String    @unique
  students Student[]
}

model Grade {
  id              Int           @id @default(autoincrement())
  name            String
  educationType   EducationType @relation(fields: [educationTypeId], references: [id])
  educationTypeId Int
  division        Division[]
  students        Student[]
  Teacher         Teacher[]
  courses         Course[]
  lecture         Lecture[]

  @@unique([educationTypeId, name])
}

model Teacher {
  id              Int           @id
  user            User          @relation(fields: [id], references: [id], onDelete: Cascade)
  subject         String
  bio             String?
  socialMedia     Json?         @default("{}")
  educationType   EducationType @relation(fields: [educationTypeId], references: [id])
  educationTypeId Int
  grade           Grade[]
  division        Division[]
  isActive        Boolean       @default(false)
  courses         Course[]
  Lecture         Lecture[]
}

model Guardian {
  id          Int       @id
  user        User      @relation(fields: [id], references: [id], onDelete: Cascade)
  phoneNumber String    @unique
  students    Student[]
}

model Admin {
  id                  Int     @id
  user                User    @relation(fields: [id], references: [id], onDelete: Cascade)
  teacherRegistration Boolean @default(true)
}
